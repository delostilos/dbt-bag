version: 2

sources:
- name: lz_bag
  loader: shell
  meta:
    extension: zip
    external_location: ( values('{{ var('sourcedir') }}', '{mnemonic}', '{extension}') )
  tables:
  - name: extract_levering
    columns: 
    - name: sourcedir
    - name: mnemonic
    - name: extension
    meta:
      extension: xml
      mnemonic: BAG 
     
  - name: gemeente_woonplaats_relatie
    meta:
      mnemonic: GEM-WPL-RELATIE- 
  - name: gemeente_tabel
    columns:
    - name: '"92.10 Gemeentecode"'
    - name: '"92.11 Omschrijving"'
    - name: '"92.12 Nieuwe code"'
    - name: '"99.98 Datum ingang"'    
    - name: '"99.99 Datum einde"'
    meta: 
      external_location: read_csv('{{ var('sourcedir') }}gemeenten_tabel_utf8.csv')       
  - name: ligplaats
    meta:
      mnemonic: LIG
  - name: nummeraanduiding
    meta:
      mnemonic: NUM  
  - name: openbareruimte
    meta:
      mnemonic: OPR       
  - name: pand
    meta:
      mnemonic: PND 
  - name: standplaats
    meta:
      mnemonic: STA  
  - name: verblijfsobject
    meta:
      mnemonic: VBO                       
  - name: woonplaats
    meta:
      mnemonic: WPL        